<div
  class="container mx-auto px-4 pb-12 "
  data-collection-root
>
  {% if section.settings.category_cards %}
    {% render 'store-category-cards' %}
  {% endif %}
  <div id="products">
    <div class="relative transition-hide">
      <h2 class="pb-12">{{ collection.title | default: 'Produkti' }}</h2>

      <!-- Filters as Dropdowns on Desktop -->
      <div
        class="hidden filters-container sm:flex flex-col sm:flex-row sm:flex-wrap gap-4 mb-12"
        x-ref="filtersDesktop"
      >
        {% render 'filter-regular' %}
        {% render 'filter-sort-by' %}
        {% render 'btn-clear-filter' %}
      </div>

      <!-- Mobile filters wrapped in a single dropdown -->
      <div x-ref="mobileFilterWrapper">
        {% render 'mobile-filter-wrapper' %}
      </div>

      {% paginate collection.products by 12 %}
        <div class="relative z-1">
          {% render 'loading-screen' %}

          <div
            class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 md:gap-12 transition-opacity duration-300 h-full"
            x-ref="productGrid"
            :class="{ 'opacity-30': loading }"
          >
            {% for product in collection.products %}
              <div class="flex flex-col justify-between space-y-3">
                {% render 'product-card', product: product %}
              </div>
            {% else %}
              <div class="col-span-full text-center py-12">
                <p class="text-gray-600">Nav atrasti produkti ar šiem filtriem.</p>
              </div>
            {% endfor %}
          </div>

          <!-- Pagination -->
          <div x-ref="pagination">
            {% render 'paginate', paginate: paginate %}
          </div>
        </div>
      {% endpaginate %}
    </div>
  </div>
</div>
<script src="{{ 'collection-pagination.js' | asset_url }}" defer></script>

{% schema %}
{
  "name": "All Products",
  "settings": [
    {
      "type": "range",
      "id": "products_per_page",
      "label": "Products per page",
      "min": 8,
      "max": 24,
      "step": 4,
      "default": 12
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Kategoriju sadaļas nosaukums",
      "default": "Kategorijas"
    },
    {
      "type": "checkbox",
      "id": "category_cards",
      "label": "Kategorija kārtis",
      "default": true
    }
  ],
  "blocks": [
    {
      "type": "category_slide",
      "name": "Category Slide",
      "settings": [
        {
          "type": "image_picker",
          "id": "photo",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "name",
          "label": "Kartes teksts",
          "info": "Teksts parādās uz kartes"
        },
        {
          "type": "text",
          "id": "category_name_for_filter",
          "label": "Produkta kategorija",
          "info": "Ievadi kategorijas nosaukumu (jābūt identiskam ar metafield vērtību)",
          "placeholder": "Sejas Kopšana"
        }
      ]
    }
  ]
}
{% endschema %}
