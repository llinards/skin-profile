<section class="container mx-auto px-4 mb-12 transition-hide">
  <h2 class="text-center mb-12">{{ section.settings.heading }}</h2>
  <div class="mx-auto max-w-3xl space-y-6">
    {% for block in section.blocks %}
      {% if block.type == 'dropdown' %}
        <div
          {{ block.shopify_attributes }}
          x-data="{ open: {{ block.settings.open | json }} }"
          class="p-2 shadow-[0_4px_12px_0_rgba(0,0,0,0.35)] hover:bg-sp-light-brown transition-all duration-300 cursor-pointer rounded-md"
          :class="open ? 'bg-sp-light-brown' : ''"
        >
          <button
            type="button"
            @click="open = !open"
            class="w-full flex items-center justify-between gap-3 px-2 py-2 text-left cursor-pointer"
            :aria-expanded="open.toString()"
            :aria-controls="'panel-{{ block.id }}'"
            :aria-label="open ? 'Aizvērt jautājuma atbildi' : 'Atvērt jautājuma atbildi'"
            id="accordion-header-{{ block.id }}"
          >
            <h3 class="flex-1 min-w-0 text-sm tracking-wider font-bold body-font">
              {{ block.settings.title }}
            </h3>

            <span class="ml-3 inline-flex h-6 w-6 items-center justify-center rounded-full bg-sp-brown text-white transition-colors">
              <svg
                x-cloak
                x-show="!open"
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="1.8"
              >
                <path stroke-linecap="round" d="M12 5v14M5 12h14" />
              </svg>
              <svg
                x-cloak
                x-show="open"
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="1.8"
              >
                <path stroke-linecap="round" d="M5 12h14" />
              </svg>
            </span>
          </button>

          <div
            id="panel-{{ block.id }}"
            role="region"
            aria-labelledby="accordion-header-{{ block.id }}"
            x-show="open"
            x-transition
            class="px-2 pb-4"
          >
            {{ block.settings.content }}
          </div>
        </div>
      {% endif %}
    {% endfor %}
  </div>
</section>

{% schema %}
{
  "name": "Dropdown - BUJ",
  "settings": [{ "type": "text", "id": "heading", "label": "Virsraksts", "default": "Virsraksts šeit" }],
  "blocks": [
    {
      "type": "dropdown",
      "name": "Jautājums",
      "settings": [
        { "type": "text", "id": "title", "label": "Virsraksts", "default": "Biežāk uzdotais jautājums" },
        { "type": "richtext", "id": "content", "label": "Saturs", "default": "<p>Atbilde uz jautājumu.</p>" },
        { "type": "checkbox", "id": "open", "label": "Atvērt pēc noklusējuma", "default": false }
      ]
    }
  ],
  "presets": [{ "name": "Dropdown - BUJ", "blocks": [{ "type": "dropdown" }, { "type": "dropdown" }] }]
}
{% endschema %}
