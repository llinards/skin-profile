{% for block in section.blocks %}
  <div x-data="{ open: {{ block.settings.open_by_default | json }} }" class="border-t-2 overflow-hidden">
    <button @click="open = !open" class="w-full flex justify-between items-center py-4">
      <h3 class="text-2xl">{{ block.settings.title }}</h3>
      <svg class="w-6 h-6 transition-transform" :class="{ 'rotate-180': open }">
        <path d="m19.5 8.25-7.5 7.5-7.5-7.5"/>
      </svg>
    </button>

    <div x-show="open" x-cloak class="mt-4 space-y-2">
      {{ block.settings.content }}

      {% if block.settings.services_json != blank %}
        {% assign services = block.settings.services_json | json %}
        <table class="w-full">
          <tbody>
            {% for service in services %}
              <tr>
                <td>{{ service.name }}</td>
                <td>{{ service.price }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      {% endif %}
    </div>
  </div>
{% endfor %}

{% schema %}
{
  "name": "Dropdowns Section",
  "settings": [],
  "blocks": [
    {
      "type": "dropdown",
      "name": "Dropdown Teksts",
      "settings": [
        { "type": "text", "id": "title", "label": "Virsraksts", "default": "Noklikšķiniet, lai atvērtu" },
        { "type": "richtext", "id": "content", "label": "Saturs", "default": "<p>Jūsu teksts šeit.</p>" },
        { "type": "checkbox", "id": "open_by_default", "label": "Atvērt pēc noklusējuma", "default": false },
        {
          "type": "textarea",
          "id": "services_json",
          "label": "Pakalpojumi (JSON formātā)",
          "info": "Piemērs: [{\"name\":\"Sejas tīrīšana\",\"price\":\"€45\"},{\"name\":\"Masāža\",\"price\":\"€60\"}]"
        }
      ]
    }
  ],
  "presets": [{ "name": "Dropdown saraksts" }]
}
{% endschema %}
