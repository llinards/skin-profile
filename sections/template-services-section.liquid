<div class="container mx-auto px-4 transition-hide max-w-7xl{% if section.settings.space_bottom %} mb-12{% endif %}">
  {%- assign title = title | default: 'Dropdown Title' -%}
  {%- assign body = body | default: '<p>Add your content here.</p>' -%}
  {%- assign open_by_default = open_by_default | default: false -%}

  <div
    x-data="{ open: {{ section.settings.open_by_default | json }} }"
    class="overflow-hidden border-t-2"
  >
    <!-- Header -->
    <button
      type="button"
      @click="open = !open"
      class="w-full flex items-center justify-between px-2 py-4 text-left hover:bg-sp-light-brown/30 transition-colors"
      :aria-expanded="open.toString()"
      :aria-label="open ? 'Aizvērt sadaļu' : 'Atvērt sadaļu'"
    >
      <h3 class="text-2xl md:text-4xl">
        {{ section.settings.title }}
      </h3>

      <!-- Icon: plus when closed, minus when open -->
      <span
        class="ml-3 inline-flex h-9 w-9 items-center justify-center rounded-full bg-sp-light-brown text-sp-brown border border-[#E6DAC8] transition-colors hover:bg-sp-brown hover:text-white"
      >
        <!-- Plus -->
        <svg
          x-cloak
          x-show="!open"
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="1.8"
          aria-hidden="true"
        >
          <path stroke-linecap="round" d="M12 5v14M5 12h14" />
        </svg>

        <!-- Minus -->
        <svg
          x-cloak
          x-show="open"
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="1.8"
          aria-hidden="true"
        >
          <path stroke-linecap="round" d="M5 12h14" />
        </svg>
      </span>
    </button>

    <!-- Body -->
    <div
      x-cloak
      x-show="open"
      x-transition:enter="transition ease-out duration-200"
      x-transition:enter-start="opacity-0 -translate-y-2"
      x-transition:enter-end="opacity-100 translate-y-0"
      x-transition:leave="transition ease-in duration-150"
      x-transition:leave-start="opacity-100 translate-y-0"
      x-transition:leave-end="opacity-0 -translate-y-2"
      class="px-2 my-4 space-y-2"
    >
      {{ section.settings.content }}

      {% render 'services-table',
        services: section.blocks,
        show_headers: true,
        disclaimer: section.settings.service_disclaimer
      %}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Dropdown Teksts",
  "settings": [
    { "type": "text", "id": "title", "label": "Virsraksts", "default": "Noklikšķiniet, lai atvērtu" },
    { "type": "richtext", "id": "content", "label": "Saturs", "default": "<p>Jūsu teksts šeit.</p>" },
    {
      "type": "text",
      "id": "service_disclaimer",
      "label": "Atruna zem virsraksta",
      "info": "Parādās zem pakalpojumu virsrakstiem."
    },
    { "type": "checkbox", "id": "open_by_default", "label": "Atvērt pēc noklusējuma", "default": false },
    {
      "type": "checkbox",
      "id": "space_bottom",
      "label": "Atstarpe",
      "info": "Pievienot apakšējo atstarpi (mb-12) šai sadaļai.",
      "default": false
    }
  ],
  "blocks": [
    {
      "type": "service",
      "name": "Pakalpojums",
      "settings": [
        { "type": "text", "id": "service_name", "label": "Pakalpojuma nosaukums", "default": "Sejas tīrīšana" },
        { "type": "text", "id": "service_price", "label": "Cena", "default": "€45" }
      ]
    }
  ],
  "presets": [{ "name": "Dropdown Teksts" }]
}
{% endschema %}
