<div class="container mx-auto px-4 pb-12 transition-hide" x-data="{ activeTab: 0 }">
  <!-- Tabs Navigation -->
  {% if section.blocks.size > 0 %}
    <div class="flex justify-center mb-8 md:mb-12">
      <div class="inline-flex flex-wrap justify-center gap-2 md:gap-4">
        {% for block in section.blocks %}
          {% if block.type == 'tab' %}
            <button
              @click="activeTab = {{ forloop.index0 }}"
              :class="activeTab === {{ forloop.index0 }} ? 'bg-sp-brown text-white' : 'bg-white text-sp-brown border-2 border-sp-brown'"
              class="px-4 md:px-6 py-2 md:py-3 rounded-full text-sm md:text-base font-medium transition-all duration-300 hover:bg-sp-brown hover:text-white"
            >
              {{ block.settings.tab_label }}
            </button>
          {% endif %}
        {% endfor %}
      </div>
    </div>
  {% endif %}

  <!-- Tab Content -->
  {% for block in section.blocks %}
    {% if block.type == 'tab' %}
      <div
        x-show="activeTab === {{ forloop.index0 }}"
        x-transition:enter="transition ease-out duration-300"
        x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100"
        {{ block.shopify_attributes }}
      >
        <div class="md:flex md:gap-x-24 md:items-center">
          <!-- Left column: Text content -->
          <div class="flex flex-col md:w-1/2 items-center md:items-start justify-center space-y-6 md:space-y-12 mb-8 md:mb-0">
            <h2 class="text-center md:text-left">{{ block.settings.heading }}</h2>
            <div class="space-y-2 text-center md:text-left sp-link">
              {{ block.settings.text }}
            </div>

            <!-- Desktop Button -->
            {% if block.settings.button_text != blank and block.settings.button_url != blank %}
              <div class="hidden md:flex w-full justify-center md:justify-start">
                {% case block.settings.button_style %}
                  {% when 'white' %}
                    {% render 'btn-white', text: block.settings.button_text, url: block.settings.button_url %}
                  {% when 'brown' %}
                    {% render 'btn-brown', text: block.settings.button_text, url: block.settings.button_url %}
                {% endcase %}
              </div>
            {% endif %}
          </div>

          <!-- Right column: Image -->
          <div class="w-full md:w-1/2">
            {% if block.settings.image != blank %}
              <img
                src="{{ block.settings.image | image_url: width: 1024 }}"
                alt="{{ block.settings.alt_text }}"
                class="w-full h-auto rounded-lg"
                width="1024"
                height="1024"
                loading="lazy"
              >
            {% else %}
              <div class="w-full aspect-square bg-gray-200 rounded-lg flex items-center justify-center">
                <p class="text-gray-400">{{ 'general.image_placeholder' | t | default: 'Image placeholder' }}</p>
              </div>
            {% endif %}
          </div>

          <!-- Mobile Button -->
          {% if block.settings.button_text != blank and block.settings.button_url != blank %}
            <div class="md:hidden flex justify-center w-full mt-6">
              {% case block.settings.button_style %}
                {% when 'white' %}
                  {% render 'btn-white', text: block.settings.button_text, url: block.settings.button_url %}
                {% when 'brown' %}
                  {% render 'btn-brown', text: block.settings.button_text, url: block.settings.button_url %}
              {% endcase %}
            </div>
          {% endif %}
        </div>
      </div>
    {% endif %}
  {% endfor %}
</div>

{% schema %}
{
  "name": "Tab Switcher Section",
  "settings": [],
  "blocks": [
    {
      "type": "tab",
      "name": "Tab",
      "limit": 4,
      "settings": [
        {
          "type": "text",
          "id": "tab_label",
          "label": "Tab Label",
          "default": "Tab",
          "info": "The label displayed on the tab button"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Tab Heading"
        },
        {
          "type": "richtext",
          "id": "text",
          "label": "Text Content",
          "default": "<p>Your content here.</p>"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "alt_text",
          "label": "Image Alt Text",
          "default": "Tab image"
        },
        {
          "type": "text",
          "id": "button_text",
          "label": "Button Text",
          "default": "Learn More"
        },
        {
          "type": "url",
          "id": "button_url",
          "label": "Button Link"
        },
        {
          "type": "select",
          "id": "button_style",
          "label": "Button Style",
          "options": [
            { "value": "white", "label": "White" },
            { "value": "brown", "label": "Brown" }
          ],
          "default": "brown"
        }
      ]
    }
  ],
  "max_blocks": 4,
  "presets": [
    {
      "name": "Tab Switcher Section",
      "blocks": [
        {
          "type": "tab",
          "settings": {
            "tab_label": "Tab 1",
            "heading": "First Tab",
            "text": "<p>Content for the first tab.</p>",
            "button_text": "Learn More"
          }
        }
      ]
    }
  ]
}
{% endschema %}
