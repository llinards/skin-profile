<div class="container mx-auto px-4 transition-hide max-w-8xl{% if section.settings.space_bottom %} mb-12{% endif %}">
  <div
    x-data="{ open: {{ section.settings.open_by_default | json }} }"
    class="overflow-hidden border-t-2"
  >
    <!-- Header -->
    <button
      type="button"
      @click="open = !open"
      class="
        group relative w-full flex items-start gap-3 px-2 md:px-0 py-4 text-left hover:bg-sp-light-brown active:bg-sp-light-brown transition-colors cursor-pointer
        rounded-md focus-visible:ring-1 focus-visible:ring-inset
      "
      :aria-expanded="open.toString()"
      :aria-label="open ? 'Aizvērt sadaļu' : 'Atvērt sadaļu'"
    >
      <h3 class="text-xl md:text-4xl leading-tight">
        {{ section.settings.title }}
      </h3>

      <!-- Icon wrapper -->
      <span
        class="
                    absolute top-4 right-2 inline-flex h-9 w-9 aspect-square items-center justify-center rounded-full border border-sp-light-brown transition-colors select-none
          group-hover:bg-sp-brown group-hover:text-white
        "

        :class="open ? 'bg-sp-brown text-white' : 'bg-sp-light-brown text-sp-brown'"
      >
        <!-- Plus -->
        <svg
          x-cloak
          x-show="!open"
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="1.8"
          aria-hidden="true"
        >
          <path stroke-linecap="round" d="M12 5v14M5 12h14" />
        </svg>

        <!-- Minus -->
        <svg
          x-cloak
          x-show="open"
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5 pointer-events-none"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="1.8"
          aria-hidden="true"
        >
          <path stroke-linecap="round" d="M5 12h14" />
        </svg>
      </span>
    </button>

    <!-- Body -->
    <div
      x-cloak
      x-show="open"
      x-transition:enter="transition ease-out duration-200"
      x-transition:enter-start="opacity-0 -translate-y-2"
      x-transition:enter-end="opacity-100 translate-y-0"
      x-transition:leave="transition ease-in duration-150"
      x-transition:leave-start="opacity-100 translate-y-0"
      x-transition:leave-end="opacity-0 -translate-y-2"
      class="px-2 my-4 space-y-2"
    >
      <div class="flex flex-col md:flex-row items-start mb-6 gap-6">
        <div class="flex-1 rte">
          {{ section.settings.content }}
        </div>
        <div class="w-full md:w-auto md:ml-auto">
          {% render 'btn-brown',
            text: section.settings.service_url_cta,
            url: section.settings.service_url,
            full_width: true
          %}
        </div>
      </div>

      {% render 'services-table',
        services: section.blocks,
        show_headers: true,
        disclaimer: section.settings.service_disclaimer
      %}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Dropdown - Pakalpojums",
  "settings": [
    { "type": "text", "id": "title", "label": "Virsraksts", "default": "Noklikšķiniet, lai atvērtu" },
    { "type": "richtext", "id": "content", "label": "Saturs", "default": "<p>Jūsu teksts šeit.</p>" },

    {
      "type": "text",
      "id": "service_disclaimer",
      "label": "Atruna zem virsraksta",
      "info": "Parādās zem pakalpojumu virsrakstiem."
    },
    { "type": "url", "id": "service_url", "label": "Pakalpojuma saite (URL)" },
    { "type": "text", "id": "service_url_cta", "label": "CTA Poga", "default": "Pieteikt" },
    { "type": "checkbox", "id": "open_by_default", "label": "Atvērt pēc noklusējuma", "default": false },
    {
      "type": "checkbox",
      "id": "space_bottom",
      "label": "Atstarpe",
      "info": "Pievienot apakšējo atstarpi (mb-12) šai sadaļai.",
      "default": false
    }
  ],
  "blocks": [
    {
      "type": "service",
      "name": "Pakalpojums",
      "settings": [
        { "type": "text", "id": "service_name", "label": "Pakalpojuma nosaukums", "default": "Sejas tīrīšana" },
        { "type": "text", "id": "service_price", "label": "Cena", "default": "€45" }
      ]
    }
  ],
  "presets": [{ "name": "Dropdown - Pakalpojums" }]
}
{% endschema %}
