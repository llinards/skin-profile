<div x-data="{ open: false }" class="relative w-full mb-2">
  <button
    type="button"
    @click="open = !open"
    class="flex py-2 px-3 items-center uppercase rounded-full border border-gray-300 w-full justify-between cursor-pointer hover:bg-gray-50 transition-colors"
    aria-haspopup="listbox"
    :aria-expanded="open.toString()"
  >
    <span class="tracking-wide text-xs sm:text-sm xl:text-base truncate">
      {{ product.selected_or_first_available_variant.title }}
    </span>
    <svg
      xmlns="http://www.w3.org/2000/svg"
      fill="none"
      viewBox="0 0 24 24"
      stroke-width="1.5"
      stroke="currentColor"
      class="h-5 w-5 bg-gray-300 rounded-full p-1 transition-transform"
      :class="{ 'rotate-180': open }"
    >
      <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
    </svg>
  </button>
  <div
    x-show="open"
    @click.away="open = false"
    x-transition
    class="absolute z-10 mt-2 w-full bg-white border border-gray-300 rounded-lg shadow-lg"
    style="display: none;"
  >
    <ul class="py-2 max-h-60 overflow-y-auto list-none">
      {% for variant in product.variants %}
        <li>
          <button
            type="button"
            class="w-full text-left px-4 py-2 text-xs sm:text-sm hover:bg-gray-50 cursor-pointer transition-all duration-300"
            @click="
              $el.closest('[x-data]').querySelector('input[name=id]').value = '{{ variant.id }}';
              open = false;
              $el.closest('[x-data]').querySelector('span').textContent = '{{ variant.title | escape }}';
            "
          >
            {{ variant.title }}
          </button>
        </li>
      {% endfor %}
    </ul>
  </div>
  <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
</div>
